import{c as F,j as e,g as E,a as B,r as i,u as $,b as ve,P as ee,F as Q,d as Ce,e as A,f as I,s as b,h as y,i as L,M as Se,B as ye,m as se,T as g,k as we,l as De,n as ke,G as m,o as q,p as Pe,q as U,t as We,v as Me,w as Te,x as G,y as d,z as Re,R as Ae,I as Z,C as Ue,A as f,D as Ie,E as Fe,S as Ne,H as Ee,J as Be,K as $e,L as Le,N as _e}from"./index-C6jVgE3x.js";const ze=F(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),He=F(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),Oe=F(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),Ve=F(e.jsx("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"})),Ke=F(e.jsx("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}));function Xe(t){return B("MuiDialog",t)}const J=E("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),te=i.createContext({}),Ye=b(ye,{name:"MuiDialog",slot:"Backdrop",overrides:(t,o)=>o.backdrop})({zIndex:-1}),qe=t=>{const{classes:o,scroll:a,maxWidth:n,fullWidth:c,fullScreen:u}=t,r={root:["root"],container:["container",`scroll${y(a)}`],paper:["paper",`paperScroll${y(a)}`,`paperWidth${y(String(n))}`,c&&"paperFullWidth",u&&"paperFullScreen"]};return L(r,Xe,o)},Ge=b(Se,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),Je=b("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[o.container,o[`scroll${y(a.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Qe=b(ee,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[o.paper,o[`scrollPaper${y(a.scroll)}`],o[`paperWidth${y(String(a.maxWidth))}`],a.fullWidth&&o.paperFullWidth,a.fullScreen&&o.paperFullScreen]}})(se(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:o})=>!o.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${J.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(o=>o!=="xs").map(o=>({props:{maxWidth:o},style:{maxWidth:`${t.breakpoints.values[o]}${t.breakpoints.unit}`,[`&.${J.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[o]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:o})=>o.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:o})=>o.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${J.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Ze=i.forwardRef(function(o,a){const n=$({props:o,name:"MuiDialog"}),c=ve(),u={enter:c.transitions.duration.enteringScreen,exit:c.transitions.duration.leavingScreen},{"aria-describedby":r,"aria-labelledby":p,"aria-modal":x=!0,BackdropComponent:w,BackdropProps:D,children:_,className:k,disableEscapeKeyDown:N=!1,fullScreen:P=!1,fullWidth:z=!1,maxWidth:H="sm",onClick:j,onClose:W,open:M,PaperComponent:v=ee,PaperProps:h={},scroll:O="paper",slots:V={},slotProps:s={},TransitionComponent:l=Q,transitionDuration:C=u,TransitionProps:oe,...ae}=n,S={...n,disableEscapeKeyDown:N,fullScreen:P,fullWidth:z,maxWidth:H,scroll:O},K=qe(S),X=i.useRef(),re=R=>{X.current=R.target===R.currentTarget},le=R=>{j&&j(R),X.current&&(X.current=null,W&&W(R,"backdropClick"))},Y=Ce(p),ne=i.useMemo(()=>({titleId:Y}),[Y]),ie={transition:l,...V},ce={transition:oe,paper:h,backdrop:D,...s},T={slots:ie,slotProps:ce},[de,pe]=A("root",{elementType:Ge,shouldForwardComponentProp:!0,externalForwardedProps:T,ownerState:S,className:I(K.root,k),ref:a}),[ue,he]=A("backdrop",{elementType:Ye,shouldForwardComponentProp:!0,externalForwardedProps:T,ownerState:S}),[xe,me]=A("paper",{elementType:Qe,shouldForwardComponentProp:!0,externalForwardedProps:T,ownerState:S,className:I(K.paper,h.className)}),[ge,fe]=A("container",{elementType:Je,externalForwardedProps:T,ownerState:S,className:K.container}),[je,be]=A("transition",{elementType:Q,externalForwardedProps:T,ownerState:S,additionalProps:{appear:!0,in:M,timeout:C,role:"presentation"}});return e.jsx(de,{closeAfterTransition:!0,slots:{backdrop:ue},slotProps:{backdrop:{transitionDuration:C,as:w,...he}},disableEscapeKeyDown:N,onClose:W,open:M,onClick:le,...pe,...ae,children:e.jsx(je,{...be,children:e.jsx(ge,{onMouseDown:re,...fe,children:e.jsx(xe,{as:v,elevation:24,role:"dialog","aria-describedby":r,"aria-labelledby":Y,"aria-modal":x,...me,children:e.jsx(te.Provider,{value:ne,children:_})})})})})});function es(t){return B("MuiDialogActions",t)}E("MuiDialogActions",["root","spacing"]);const ss=t=>{const{classes:o,disableSpacing:a}=t;return L({root:["root",!a&&"spacing"]},es,o)},ts=b("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[o.root,!a.disableSpacing&&o.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:t})=>!t.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),os=i.forwardRef(function(o,a){const n=$({props:o,name:"MuiDialogActions"}),{className:c,disableSpacing:u=!1,...r}=n,p={...n,disableSpacing:u},x=ss(p);return e.jsx(ts,{className:I(x.root,c),ownerState:p,ref:a,...r})});function as(t){return B("MuiDialogContent",t)}E("MuiDialogContent",["root","dividers"]);function rs(t){return B("MuiDialogTitle",t)}const ls=E("MuiDialogTitle",["root"]),ns=t=>{const{classes:o,dividers:a}=t;return L({root:["root",a&&"dividers"]},as,o)},is=b("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:a}=t;return[o.root,a.dividers&&o.dividers]}})(se(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:o})=>o.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:o})=>!o.dividers,style:{[`.${ls.root} + &`]:{paddingTop:0}}}]}))),cs=i.forwardRef(function(o,a){const n=$({props:o,name:"MuiDialogContent"}),{className:c,dividers:u=!1,...r}=n,p={...n,dividers:u},x=ns(p);return e.jsx(is,{className:I(x.root,c),ownerState:p,ref:a,...r})}),ds=t=>{const{classes:o}=t;return L({root:["root"]},rs,o)},ps=b(g,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),us=i.forwardRef(function(o,a){const n=$({props:o,name:"MuiDialogTitle"}),{className:c,id:u,...r}=n,p=n,x=ds(p),{titleId:w=u}=i.useContext(te);return e.jsx(ps,{component:"h2",className:I(x.root,c),ownerState:p,ref:a,variant:"h6",id:u??w,...r})}),hs=({status:t})=>{const o={ACTIVE:"success.main",INACTIVE:"error.main",PENDING:"warning.main"};return e.jsxs(_e,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(U,{sx:{width:10,height:10,bgcolor:o[t]||"grey.500",borderRadius:"50%"}}),e.jsx(g,{sx:{color:o[t]||"text.primary"},children:t})]})},xs=({address:t})=>e.jsx(U,{sx:{p:2,backgroundColor:"#f5f5f5",borderTop:"1px solid #e0e0e0",borderBottom:"1px solid #e0e0e0"},children:e.jsx(m,{container:!0,spacing:2,children:e.jsxs(m,{item:!0,xs:12,md:6,children:[e.jsx(g,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"Địa chỉ:"}),e.jsxs(g,{children:["Địa chỉ chi tiết: ",t.addressDetail]}),e.jsxs(g,{children:["Quận/Huyện: ",t.district]}),e.jsxs(g,{children:["Phường/Xã: ",t.ward]}),e.jsxs(g,{children:["Tỉnh/Thành phố: ",t.province]}),e.jsxs(g,{children:["Mã bưu điện: ",t.postalCode]})]})})}),ms=["admin","shipper","customer"];function fs(){const t=we(),o=De(s=>s.users&&Array.isArray(s.users.list)?s.users.list:[]);i.useEffect(()=>{t(ke())},[t]),i.useEffect(()=>{console.log("Users from redux:",o)},[o]);const[a,n]=i.useState(!1),[c,u]=i.useState(null),[r,p]=i.useState({store_name:"",email:"",phone:"",password:"",role:"",address_detail:"",province:"",district:"",ward:""}),[x,w]=i.useState(""),[D,_]=i.useState(""),[k,N]=i.useState(""),[P,z]=i.useState(""),H=o.filter(s=>(!x||s.store_name&&s.store_name.toLowerCase().includes(x.toLowerCase()))&&(!D||s.email&&s.email.toLowerCase().includes(D.toLowerCase()))&&(!k||s.role&&s.role.toLowerCase().includes(k.toLowerCase()))&&(!P||s.status&&s.status.toLowerCase().includes(P.toLowerCase()))),[j,W]=i.useState(null),M=(s=null)=>{if(u(s),s&&s.addresses&&s.addresses.length>0){const l=s.addresses[0];p({store_name:s.store_name||"",email:s.email||"",phone:s.phone||"",password:"",role:s.role||"",address_detail:l.addressDetail||"",province:l.province||"",district:l.district||"",ward:l.ward||""})}else p({store_name:"",email:"",phone:"",password:"",role:"",address_detail:"",province:"",district:"",ward:""});n(!0)},v=()=>{n(!1),u(null)},h=s=>{p({...r,[s.target.name]:s.target.value})},O=()=>{if(!r.store_name||!r.email||!r.phone||!r.role){alert("Please fill in all required fields");return}if(!c&&!r.password){alert("Password is required for new users");return}console.log("Form data before save:",r),c?t(Be({id:c.id,data:r})).unwrap().then(s=>{console.log("User updated successfully:",s),v()}).catch(s=>{console.error("Failed to update user:",s),alert(s||"Failed to update user")}):t($e(r)).unwrap().then(s=>{console.log("User created successfully:",s),v()}).catch(s=>{console.error("Failed to create user:",s),alert(s||"Failed to create user")})},V=s=>{window.confirm("Are you sure you want to delete this user?")&&t(Le(s)).unwrap().then(l=>{console.log("User deleted successfully:",l)}).catch(l=>{console.error("Failed to delete user:",l),alert(l||"Failed to delete user")})};return e.jsxs(m,{item:!0,xs:12,md:7,lg:8,children:[e.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[e.jsx(m,{children:e.jsx(g,{variant:"h5",children:"Manage Users"})}),e.jsx(m,{children:e.jsx(q,{variant:"contained",startIcon:e.jsx(ze,{}),onClick:()=>M(),children:"Add User"})})]}),e.jsxs(Pe,{sx:{mt:2},content:!1,children:[e.jsx(U,{sx:{p:2},children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx("input",{type:"text",placeholder:"Search Name",value:x,onChange:s=>w(s.target.value),style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #ccc"}})}),e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx("input",{type:"text",placeholder:"Search Email",value:D,onChange:s=>_(s.target.value),style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #ccc"}})}),e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx("input",{type:"text",placeholder:"Search Role",value:k,onChange:s=>N(s.target.value),style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #ccc"}})}),e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsx("input",{type:"text",placeholder:"Search Status",value:P,onChange:s=>z(s.target.value),style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #ccc"}})})]})}),e.jsx(U,{children:e.jsx(We,{sx:{width:"100%",overflowX:"auto",overflowY:"auto",maxHeight:700,position:"relative",display:"block",maxWidth:"100%","& td, & th":{whiteSpace:"nowrap"}},children:e.jsxs(Me,{children:[e.jsx(Te,{children:e.jsxs(G,{children:[e.jsx(d,{children:"ID"}),e.jsx(d,{children:"Name"}),e.jsx(d,{children:"Email"}),e.jsx(d,{children:"Role"}),e.jsx(d,{children:"Phone"}),e.jsx(d,{children:"Status"}),e.jsx(d,{align:"center",children:"Actions"})]})}),e.jsx(Re,{children:H.map((s,l)=>e.jsxs(Ae.Fragment,{children:[e.jsxs(G,{hover:!0,onClick:()=>W(j===l?null:l),sx:{cursor:"pointer",backgroundColor:j===l?"#f5f5f5":"inherit","&:hover":{backgroundColor:"#f5f5f5"}},children:[e.jsxs(d,{children:[j===l?e.jsx(Ke,{fontSize:"small"}):e.jsx(Ve,{fontSize:"small"}),l+1]}),e.jsx(d,{children:s.store_name}),e.jsx(d,{children:s.email}),e.jsx(d,{children:s.role}),e.jsx(d,{children:s.phone}),e.jsx(d,{children:e.jsx(hs,{status:s.status})}),e.jsxs(d,{align:"center",children:[e.jsx(Z,{color:"primary",onClick:C=>{C.stopPropagation(),M(s)},children:e.jsx(Oe,{fontSize:"small"})}),e.jsx(Z,{color:"error",onClick:C=>{C.stopPropagation(),V(s.id)},children:e.jsx(He,{fontSize:"small"})})]})]}),e.jsx(G,{children:e.jsx(d,{colSpan:7,style:{padding:0},children:e.jsx(Ue,{in:j===l,timeout:"auto",unmountOnExit:!0,children:s.addresses&&s.addresses.length>0?e.jsx(xs,{address:s.addresses[0]}):e.jsx(U,{sx:{p:2,textAlign:"center"},children:e.jsx(g,{children:"Không có thông tin địa chỉ"})})})})})]},s.id||l))})]})})})]}),e.jsxs(Ze,{open:a,onClose:v,fullWidth:!0,maxWidth:"sm",children:[e.jsx(us,{children:c?"Edit User":"Add New User"}),e.jsxs(cs,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(f,{label:"Store Name",name:"store_name",value:r.store_name,onChange:h,fullWidth:!0}),e.jsx(f,{label:"Email",name:"email",type:"email",value:r.email,onChange:h,fullWidth:!0}),e.jsx(f,{label:"Phone",name:"phone",value:r.phone,onChange:h,fullWidth:!0}),!c&&e.jsx(f,{label:"Password",name:"password",type:"password",value:r.password,onChange:h,fullWidth:!0}),e.jsxs(Ie,{fullWidth:!0,children:[e.jsx(Fe,{children:"Role"}),e.jsx(Ne,{name:"role",value:r.role,onChange:h,label:"Role",children:ms.map(s=>e.jsx(Ee,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsx(g,{variant:"subtitle1",sx:{mt:2,fontWeight:"bold"},children:"Address Information"}),e.jsx(f,{label:"Address Detail",name:"address_detail",value:r.address_detail,onChange:h,fullWidth:!0}),e.jsx(f,{label:"Province",name:"province",value:r.province,onChange:h,fullWidth:!0}),e.jsx(f,{label:"District",name:"district",value:r.district,onChange:h,fullWidth:!0}),e.jsx(f,{label:"Ward",name:"ward",value:r.ward,onChange:h,fullWidth:!0})]}),e.jsxs(os,{children:[e.jsx(q,{onClick:v,children:"Cancel"}),e.jsx(q,{variant:"contained",onClick:O,children:c?"Update":"Create"})]})]})]})}export{fs as default};
